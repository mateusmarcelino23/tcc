<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Painel da Biblioteca</title>
    <link rel="icon" href="../imagens/1748908346791.png" type="image/x-icon" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../estilos/style.css" />
    <link rel="stylesheet" href="../estilos/painel.css" />
</head>

<body>

    <nav class="header">
        <a href="" class="header-link">
            <img src="../imagens/1748908346791.png" alt="Logo" class="header-logo" />
            <span class="header-text">Biblioteca M.V.C </span>
        </a>
        <span id="toggleSidebar" class="openbtn" onclick="toggleNav()">&#9776;</span>
    </nav>

    <!-- Menu lateral -->
    <div class="sidebar" id="mySidebar">
        <ul>
            <li><a href="relatorios.html">Relatórios</a></li>
            <li><a href="../backend/logout.php" id="logoutLink">Logout</a></li>
        </ul>
    </div>

    <div class="welcome">
        Bem-vindo(a), <span id="nomeProfessor"></span>!
    </div>

    <div class="explanation">Painel do Professor</div>

    <div class="container">
        <div class="btn-container">
            <a href="ver_emprestimos.html" class="btn">Empréstimos</a>
            <a href="cadastrar_livros.html" class="btn">Cadastrar Livros</a>
            <a href="ver_alunos.html" class="btn">Alunos</a>
            <a href="ver_professores.html" class="btn">Professores</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="trabalho_crud/interatividade/script.js"></script>
    <script src="trabalho_crud/interatividade/devtools_block.js"></script>
    <script src="trabalho_crud/interatividade/logout.js"></script>

    <script>
        async function carregarNomeProfessor() {
            try {
                const response = await fetch('../backend/painel.php', {
                    credentials: 'include' // para enviar cookies de sessão
                });
                if (!response.ok) {
                    if (response.status === 401) {
                        // Redireciona para login se não autenticado
                        window.location.href = '../';
                        return;
                    }
                    throw new Error('Erro ao carregar dados');
                }
                const data = await response.json();
                document.getElementById('nomeProfessor').textContent = data.professor_primeiro_nome;
            } catch (error) {
                console.error(error);
                document.getElementById('nomeProfessor').textContent = "Visitante";
            }
        }
        carregarNomeProfessor();
    </script>

    <!-- Funções extras -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../interatividade/checar_sessao.js"></script>
    <script src="../interatividade/script.js"></script>
    <script src="../interatividade/devtools_block.js"></script>
    <script src="../interatividade/logout.js"></script>
</body>

</html>